<?xml version="1.0" encoding="utf-8"?>

<UserControl
    x:Class="CroomsBellScheduleCS.Controls.ProwlerPost"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:cui="using:CroomsBellScheduleCS.Controls"
    mc:Ignorable="d">

    <Grid Padding="12" Margin="0,7,0,0" CornerRadius="10" Background="{ThemeResource CardBackgroundFillColorDefault}"
              PointerEntered="Grid_PointerEntered"
              PointerExited="Grid_PointerExited">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Button Margin="0,0,20,0" Grid.Column="0" VerticalAlignment="Top" Padding="0" BorderThickness="0" Background="Transparent" Tag="{x:Bind AuthorAndID}" Click="HandleUserProfile_Click">
            <Ellipse Width="32" Height="32">
                <Ellipse.Fill>
                    <ImageBrush x:Name="PfpBrush"/>
                </Ellipse.Fill>
            </Ellipse>
        </Button>

        <Grid Grid.Column="1" CornerRadius="{StaticResource ControlCornerRadius}">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
                <RowDefinition Height="auto"/>
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="auto"/>
            </Grid.ColumnDefinitions>
            <Button BorderThickness="0" Padding="0" Background="Transparent" Tag="{x:Bind AuthorAndID, Mode=OneWay}" Click="HandleUserProfile_Click">
                <TextBlock Grid.Row="0" Grid.Column="0" Text="{x:Bind Author, Mode=OneWay}" Margin="0, 0, 0, 0" FontSize="15" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
            </Button>
            <TextBlock x:Name="DateLabel" Grid.Row="1" Grid.Column="0" Margin="0, 0, 0, 8" FontSize="15" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>

            <Button x:Name="ProwlerItemMenu" Grid.Row="0" Grid.Column="1" MaxWidth="20" MaxHeight="20" 
Margin="0" Padding="0" BorderThickness="0" Background="Transparent"
Visibility="Collapsed">
                <FontIcon Glyph="&#xE712;" />

                <Button.Flyout>
                    <MenuFlyout Placement="Bottom">
                        <MenuFlyoutItem Text="Edit" Visibility="{x:Bind CanEdit, Mode=OneWay}" Tag="{x:Bind Id, Mode=OneWay}" Click="NotImpl_Click">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE70F;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>

                        <MenuFlyoutItem Text="Delete" Visibility="{x:Bind CanEdit, Mode=OneWay}" Tag="{x:Bind Id, Mode=OneWay}" Click="DeletePost_Click">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE74D;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>

                        <MenuFlyoutSeparator Visibility="{x:Bind CanEdit, Mode=OneWay}"/>

                        <MenuFlyoutItem Text="Report" Tag="{x:Bind Id, Mode=OneWay}" Click="Report_Click">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE730;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Ban user" Visibility="{x:Bind CanBan, Mode=OneWay}" Tag="{x:Bind AuthorId, Mode=OneWay}" Click="BanUser_Click">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE7BA;" />
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                    </MenuFlyout>
                </Button.Flyout>
            </Button>

            <cui:FeedEntry Grid.Row="2" Grid.ColumnSpan="2" ContentData="{x:Bind ContentData, Mode=OneWay}" Padding="0, 0, 0, 5" FontSize="18"/>
        </Grid>
    </Grid>
</UserControl>